{"ast":null,"code":"import _regeneratorRuntime from\"D:/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/social-space/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/social-space/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import{useDispatch}from'react-redux';import{open}from'../../features/redux/openChatSlice';import{setIdChat}from'../../features/redux/idChatSlice';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatList(props){var dispatch=useDispatch();var chats=[];var lastMessage=[];if(props.data!=null){props.data.sort(function(a,b){if(a.date<b.date){return 1;}if(a.date>b.date){return-1;}return 0;}).forEach(function(element){if(element.type===\"private\"){chats.push(element.username+\"----\"+element.userAvatar);lastMessage.push(element.text);}});}var activeChat=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var i,element;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:for(i=0;i<=chats.length;i++){element=document.getElementById(i);if(element){if(id===i){element.style.backgroundColor=\"#353535\";}else{element.style.backgroundColor=null;}}}case 1:case\"end\":return _context.stop();}},_callee);}));return function activeChat(_x){return _ref.apply(this,arguments);};}();var nullAvatar=function nullAvatar(id,username){var img=document.getElementById(id+\"img\");img.outerHTML=\"<p id=\"+id+\" className='chatAvatarNull'>\"+username[0].toUpperCase()+\"</p>\";};return/*#__PURE__*/_jsx(\"div\",{className:\"ChatListAll\",children:chats.sort().filter(function(element,index,arr){return!index||element.split('----')[0]!==arr[index-1].split('----')[0];}).map(function(data,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"ChatList\",id:chats.indexOf(data),onClick:function onClick(){dispatch(open());dispatch(setIdChat(data.split('----')[0]));activeChat(chats.indexOf(data));},children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar\",children:/*#__PURE__*/_jsx(\"img\",{id:index+\"img\",src:\"data:image/jpeg;base64,\"+data.split('----')[1],alt:\"avatar\",width:80,onError:function onError(){nullAvatar(index,data.split('----')[0]);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"userName\",children:data.split('----')[0]}),/*#__PURE__*/_jsx(\"p\",{className:\"lastMessage\",children:lastMessage[chats.indexOf(data)]?lastMessage[chats.indexOf(data)]:/*#__PURE__*/_jsx(\"p\",{className:\"gray\",children:\"*\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"})})]})]},index);})});}","map":{"version":3,"names":["React","useDispatch","open","setIdChat","ChatList","props","dispatch","chats","lastMessage","data","sort","a","b","date","forEach","element","type","push","username","userAvatar","text","activeChat","id","i","length","document","getElementById","style","backgroundColor","nullAvatar","img","outerHTML","toUpperCase","filter","index","arr","split","map","indexOf"],"sources":["D:/Проекты/social-space/frontend/src/component/Chat/ChatList.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { open } from '../../features/redux/openChatSlice';\r\nimport { setIdChat } from '../../features/redux/idChatSlice';\r\n\r\nexport default function ChatList(props) {\r\n    const dispatch = useDispatch()\r\n  \r\n    const chats = [];\r\n    const lastMessage = [];\r\n\r\n    if(props.data != null){\r\n        props.data.sort(function(a,b){\r\n                if(a.date < b.date){ return 1 }\r\n                if(a.date > b.date){ return -1 }\r\n                return 0;\r\n            }).forEach(element => {\r\n                if(element.type === \"private\"){\r\n                    chats.push(element.username + \"----\" + element.userAvatar);\r\n                    lastMessage.push(element.text);\r\n                }\r\n        });\r\n    }\r\n    \r\n    const activeChat = async (id) => {\r\n        for(let i = 0; i <= chats.length; i++){\r\n            let element = document.getElementById(i);\r\n            if(element){\r\n                if(id === i){\r\n                    element.style.backgroundColor = \"#353535\";\r\n                } else{\r\n                    element.style.backgroundColor = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const nullAvatar = (id, username) => {\r\n        let img = document.getElementById(id + \"img\");\r\n        img.outerHTML = \"<p id=\" + id +\" className='chatAvatarNull'>\" + username[0].toUpperCase() + \"</p>\";\r\n    }\r\n\r\n\r\n    return(\r\n        <div className='ChatListAll'>   \r\n            {chats.sort().filter((element, index, arr) => {\r\n                return !index || element.split('----')[0] !== arr[index-1].split('----')[0];\r\n            }).map((data, index) => {\r\n                return (\r\n                    <div className=\"ChatList\" id = {chats.indexOf(data)} key = {index} onClick = {() => {\r\n                        dispatch(open());\r\n                        dispatch(setIdChat(data.split('----')[0]));\r\n                        activeChat(chats.indexOf(data));\r\n                    }}>\r\n                        <div className='avatar'>\r\n                            <img id={index+\"img\"} src={ \"data:image/jpeg;base64,\" + data.split('----')[1] }\r\n                             alt=\"avatar\" width={80} onError={()=>{nullAvatar(index, data.split('----')[0])}}/>\r\n                        </div>\r\n                        <div className='text'>\r\n                            <p className='userName'>{ data.split('----')[0] }</p>\r\n                        <p className='lastMessage'>{ lastMessage[chats.indexOf(data)]? lastMessage[chats.indexOf(data)] : <p className='gray'>*Изображение</p> }</p>\r\n                        </div>\r\n                    </div>\r\n                ) \r\n            })}\r\n        </div>\r\n    );\r\n}"],"mappings":"kUAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,aAAa,CACzC,OAASC,IAAI,KAAQ,oCAAoC,CACzD,OAASC,SAAS,KAAQ,kCAAkC,CAAC,wFAE7D,cAAe,SAASC,SAAQ,CAACC,KAAK,CAAE,CACpC,GAAMC,SAAQ,CAAGL,WAAW,EAAE,CAE9B,GAAMM,MAAK,CAAG,EAAE,CAChB,GAAMC,YAAW,CAAG,EAAE,CAEtB,GAAGH,KAAK,CAACI,IAAI,EAAI,IAAI,CAAC,CAClBJ,KAAK,CAACI,IAAI,CAACC,IAAI,CAAC,SAASC,CAAC,CAACC,CAAC,CAAC,CACrB,GAAGD,CAAC,CAACE,IAAI,CAAGD,CAAC,CAACC,IAAI,CAAC,CAAE,MAAO,EAAC,CAAC,CAC9B,GAAGF,CAAC,CAACE,IAAI,CAAGD,CAAC,CAACC,IAAI,CAAC,CAAE,MAAO,CAAC,CAAC,CAAC,CAC/B,MAAO,EAAC,CACZ,CAAC,CAAC,CAACC,OAAO,CAAC,SAAAC,OAAO,CAAI,CAClB,GAAGA,OAAO,CAACC,IAAI,GAAK,SAAS,CAAC,CAC1BT,KAAK,CAACU,IAAI,CAACF,OAAO,CAACG,QAAQ,CAAG,MAAM,CAAGH,OAAO,CAACI,UAAU,CAAC,CAC1DX,WAAW,CAACS,IAAI,CAACF,OAAO,CAACK,IAAI,CAAC,CAClC,CACR,CAAC,CAAC,CACN,CAEA,GAAMC,WAAU,4FAAG,iBAAOC,EAAE,iIACxB,IAAQC,CAAC,CAAG,CAAC,CAAEA,CAAC,EAAIhB,KAAK,CAACiB,MAAM,CAAED,CAAC,EAAE,CAAC,CAC9BR,OAAO,CAAGU,QAAQ,CAACC,cAAc,CAACH,CAAC,CAAC,CACxC,GAAGR,OAAO,CAAC,CACP,GAAGO,EAAE,GAAKC,CAAC,CAAC,CACRR,OAAO,CAACY,KAAK,CAACC,eAAe,CAAG,SAAS,CAC7C,CAAC,IAAK,CACFb,OAAO,CAACY,KAAK,CAACC,eAAe,CAAG,IAAI,CACxC,CACJ,CACJ,CAAC,qDACJ,kBAXKP,WAAU,4CAWf,CAED,GAAMQ,WAAU,CAAG,QAAbA,WAAU,CAAIP,EAAE,CAAEJ,QAAQ,CAAK,CACjC,GAAIY,IAAG,CAAGL,QAAQ,CAACC,cAAc,CAACJ,EAAE,CAAG,KAAK,CAAC,CAC7CQ,GAAG,CAACC,SAAS,CAAG,QAAQ,CAAGT,EAAE,CAAE,8BAA8B,CAAGJ,QAAQ,CAAC,CAAC,CAAC,CAACc,WAAW,EAAE,CAAG,MAAM,CACtG,CAAC,CAGD,mBACI,YAAK,SAAS,CAAC,aAAa,UACvBzB,KAAK,CAACG,IAAI,EAAE,CAACuB,MAAM,CAAC,SAAClB,OAAO,CAAEmB,KAAK,CAAEC,GAAG,CAAK,CAC1C,MAAO,CAACD,KAAK,EAAInB,OAAO,CAACqB,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAKD,GAAG,CAACD,KAAK,CAAC,CAAC,CAAC,CAACE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAC/E,CAAC,CAAC,CAACC,GAAG,CAAC,SAAC5B,IAAI,CAAEyB,KAAK,CAAK,CACpB,mBACI,aAAK,SAAS,CAAC,UAAU,CAAC,EAAE,CAAI3B,KAAK,CAAC+B,OAAO,CAAC7B,IAAI,CAAE,CAAe,OAAO,CAAI,kBAAM,CAChFH,QAAQ,CAACJ,IAAI,EAAE,CAAC,CAChBI,QAAQ,CAACH,SAAS,CAACM,IAAI,CAAC2B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAC1Cf,UAAU,CAACd,KAAK,CAAC+B,OAAO,CAAC7B,IAAI,CAAC,CAAC,CACnC,CAAE,wBACE,YAAK,SAAS,CAAC,QAAQ,uBACnB,YAAK,EAAE,CAAEyB,KAAK,CAAC,KAAM,CAAC,GAAG,CAAG,yBAAyB,CAAGzB,IAAI,CAAC2B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAG,CAC9E,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAE,EAAG,CAAC,OAAO,CAAE,kBAAI,CAACP,UAAU,CAACK,KAAK,CAAEzB,IAAI,CAAC2B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EACjF,cACN,aAAK,SAAS,CAAC,MAAM,wBACjB,UAAG,SAAS,CAAC,UAAU,UAAG3B,IAAI,CAAC2B,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAM,cACzD,UAAG,SAAS,CAAC,aAAa,UAAG5B,WAAW,CAACD,KAAK,CAAC+B,OAAO,CAAC7B,IAAI,CAAC,CAAC,CAAED,WAAW,CAACD,KAAK,CAAC+B,OAAO,CAAC7B,IAAI,CAAC,CAAC,cAAG,UAAG,SAAS,CAAC,MAAM,UAAC,qEAAY,EAAI,EAAM,GACtI,GAZkDyB,KAAK,CAa3D,CAEd,CAAC,CAAC,EACA,CAEd"},"metadata":{},"sourceType":"module","externalDependencies":[]}