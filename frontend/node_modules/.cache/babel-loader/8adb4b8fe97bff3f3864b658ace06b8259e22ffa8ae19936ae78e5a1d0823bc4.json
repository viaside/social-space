{"ast":null,"code":"import _regeneratorRuntime from\"D:/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/social-space/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/social-space/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import convertDate from\"../../features/convertDate\";import{useSelector}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AllMessage(props){var openChat=useSelector(function(state){return state.openChat.value;});var idChat=useSelector(function(state){return state.idChat.value;});var message=[];var userPhoto;if(props.data!=null){props.data.forEach(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(element){var data,_data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(element.username===idChat&&element.type!==\"private\"){data=[element.text,convertDate(element.date),element.chatId,element.messageId,element.username,element.answers,element.nameFrom,element.userAvatar,element.textPhoto];message.push(data);}else{_data=[undefined,convertDate(element.date),element.chatId,element.messageId,element.username,element.answers,element.nameFrom,element.userAvatar,element.textPhoto];message.push(_data);}case 1:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}message.forEach(function(element){if(element[4]===idChat){userPhoto=element[7];}});var chat=document.querySelector(\"#ChatInfo2\");if(chat!=null){if(chat.scrollTop===0){chat.scrollTop=Math.pow(10,10);};}var nullAvatar=function nullAvatar(username){var img=document.getElementById(\"allchat\");img.outerHTML=\"<p className='chatAvatarNull'>\"+username[0].toUpperCase()+\"</p>\";};if(openChat===false){return null;}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"AllMessageChat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"AlLMessageUser\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar\",children:/*#__PURE__*/_jsx(\"img\",{id:\"allchat\",src:\"data:image/jpeg;base64,\"+userPhoto,alt:\"av\",width:120,onError:function onError(){nullAvatar(idChat);}})}),/*#__PURE__*/_jsx(\"p\",{className:\"userName\",children:idChat}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u0412\\u0441\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F \\u0432 \\u0433\\u0440\\u0443\\u043F\\u043F\\u0430\\u0445:\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"ChatInfo\",id:\"ChatInfo2\",children:message.reverse().map(function(data,index){if(data[0]){return/*#__PURE__*/_jsx(\"div\",{className:\"ChatInfoElement\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ChatInfoElementMessage\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"group\",children:[\"\\u0412 \",data[6]]}),/*#__PURE__*/_jsx(\"img\",{src:\"data:image/jpeg;base64,\"+data[8],alt:\"\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text\",children:data[0]}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:data[1]})]})},index);}else{return null;}})})]});}}","map":{"version":3,"names":["convertDate","useSelector","AllMessage","props","openChat","state","value","idChat","message","userPhoto","data","forEach","element","username","type","text","date","chatId","messageId","answers","nameFrom","userAvatar","textPhoto","push","undefined","chat","document","querySelector","scrollTop","Math","pow","nullAvatar","img","getElementById","outerHTML","toUpperCase","reverse","map","index"],"sources":["D:/Проекты/social-space/frontend/src/component/Chat/AllMessage.jsx"],"sourcesContent":["import convertDate from \"../../features/convertDate\";\r\nimport { useSelector } from 'react-redux';\r\n\r\nexport default function AllMessage(props) {\r\n    const openChat = useSelector((state) => state.openChat.value)\r\n    const idChat = useSelector((state) => state.idChat.value)\r\n\r\n    let message = [];\r\n    let userPhoto;\r\n\r\n    if(props.data != null){\r\n        props.data.forEach(async element => {\r\n            if(element.username === idChat && element.type !== \"private\"){\r\n                let data = [element.text, convertDate(element.date), element.chatId, element.messageId, element.username, element.answers, element.nameFrom, element.userAvatar, element.textPhoto];\r\n                message.push(data);\r\n            } else{\r\n                let data = [undefined, convertDate(element.date), element.chatId, element.messageId, element.username, element.answers, element.nameFrom, element.userAvatar, element.textPhoto];\r\n                message.push(data);\r\n            }\r\n            });\r\n    }\r\n\r\n    message.forEach(element => {\r\n        if(element[4] === idChat){\r\n            userPhoto = element[7];\r\n        }\r\n    });\r\n\r\n    let chat = document.querySelector(\"#ChatInfo2\");\r\n    if(chat != null){\r\n        if(chat.scrollTop === 0){\r\n            chat.scrollTop = Math.pow(10,10);\r\n        };\r\n    }\r\n\r\n    const nullAvatar = (username) => {\r\n        let img = document.getElementById(\"allchat\");\r\n        img.outerHTML = \"<p className='chatAvatarNull'>\" + username[0].toUpperCase() + \"</p>\";\r\n    }\r\n\r\n    if(openChat === false){\r\n        return null\r\n    } else{\r\n        return(\r\n            <div className = \"AllMessageChat\"> \r\n                <div className=\"AlLMessageUser\">\r\n                    <div className=\"avatar\">\r\n                        <img id=\"allchat\" src={ \"data:image/jpeg;base64,\" + userPhoto } alt=\"av\" width={120} onError={()=>{nullAvatar(idChat)}}/>\r\n                    </div> \r\n                    <p className=\"userName\">{ idChat }</p>\r\n                    <p>Все сообщения в группах:</p>\r\n                </div> \r\n                <div className = \"ChatInfo\" id=\"ChatInfo2\" >\r\n                    {message.reverse().map((data, index) => {\r\n                        if(data[0]){\r\n                            return (\r\n                                <div className = \"ChatInfoElement\" key={index}> \r\n                                    <div className = \"ChatInfoElementMessage\">\r\n                                        <p className = \"group\">В { data[6] }</p>\r\n                                        <img src={ \"data:image/jpeg;base64,\" + data[8] } alt=\"\"/>\r\n                                        <p className = \"text\">{ data[0] }</p>\r\n                                        <p className = \"time\">{ data[1] }</p>\r\n                                    </div>\r\n                                </div>\r\n                        )\r\n                        } else{\r\n                            return null\r\n                        }   \r\n                    })}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}